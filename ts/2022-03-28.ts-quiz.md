
# TyepScript Quiz

ä»¥ä¸‹å¾ˆå¤šéƒ¨åˆ†æ¥è‡ª[learntypescript.dev](https://learntypescript.dev/01/l3-quiz), ä»¥ä¸€é—®ä¸€ç­”çš„ç»“æ„ï¼Œçœ‹åˆ°é—®é¢˜å»ºè®®å…ˆè‡ªå·±è¿‡ä¸€ä¸‹èƒ½ä¸èƒ½å›ç­”ï¼Œå†å¾€ä¸‹çœ‹ç­”æ¡ˆã€‚

## ReturnTypeè¿”å›setTimeoutçš„ç±»å‹

`timer = setTimeout(func, time)`è¡¨ç¤ºå»¶è¿Ÿæ‰§è¡Œï¼Œ`func`æ˜¯ä¸€ä¸ªå‡½æ•°,`time`æ˜¯æ•°å­—æ—¶é—´ï¼Œè¿”å›ä¸€ä¸ª`timer`å¯ä»¥å–æ¶ˆå‡½æ•°æ‰§è¡Œã€‚è™½ç„¶çŸ¥é“timeræ˜¯ä¸ªæ•°å­—ä½†æ˜¯è¡¨ç¤ºå¹¶ä¸å¥½ï¼Œå¯ä»¥ä½¿ç”¨`ReturnType`å‡½æ•°è·å–åˆ°æœ€ç»ˆtimerçš„ç±»å‹

```tsx
let timer: ReturnType<typeof setTimeout> = setTimeout(() => {
  // do something
})
```

## as constä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

```tsx
const tesla = ['tesla', 'model 3', 'model X', 'model Y'] as const
// è¿™é‡Œteslaä¼šæˆä¸ºreadonlyçš„tupleï¼Œå› ä¸ºconstæ˜¯ä¸å¯å˜çš„
// const tesla: readonly ["tesla", "model 3", "model X", "model Y"]
```

## Date

```tsx
let dateOfBirth = new Date(1990, 4, 7); // æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ
// ç­”æ¡ˆæ˜¯Date
```

## Const

```tsx
const firstName = "Bob";  // æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ
// ç­”æ¡ˆæ˜¯constï¼Œreadonlyå¸¸é‡ï¼Œè¿™ä¸ªç§°ä¸ºå­—ç¬¦ä¸²å­—é¢é‡ï¼ˆç®€å•ç±»å‹å¯ä»¥ç›´æ¥æ¨æ–­ï¼‰ï¼Œä½†æ˜¯å¦‚æœä¸æ˜¯ç®€å•ç±»å‹ï¼Œåˆ™åªä¼šæ¨æ–­ä¸ºæ™®é€šï¼Œå¦‚ä¸Šä¸ªä¾‹å­çš„Date
```

## let

```tsx
const last = "Smith";
let surname = last; // surnameè¢«æ¨æ–­ä¸ºstringç±»å‹ï¼Œletå¯å˜ï¼Œä¸å¯ä»¥ç¡®å®šç¼©å°èŒƒå›´ï¼Œconstä¸å¯å˜ï¼Œå¯ä»¥ç¼©å°èŒƒå›´
```

## é»˜è®¤anyæ¨æ–­

é‡ç‚¹ï¼é‡ç‚¹ï¼é‡ç‚¹ï¼å°±æ˜¯å› ä¸ºé»˜è®¤anyæ¨æ–­ï¼Œæ‰€ä»¥æ­¤æ—¶ä¸åŠ ä¸Šå‚æ•°ç±»å‹ä¼šå¯¼è‡´anyæ³›æ»¥ï¼Œå†™TSä»£ç å°±æ˜¯åŠ ä¸Šåˆé€‚çš„æ³¨é‡Šï¼Œé˜²æ­¢anyæ³›æ»¥å¼•èµ·ç±»å‹æ¨æ–­æ— æ•ˆ

```tsx
let counter;
counter = 10; // counteræ¨æ–­ä¸ºanyï¼Œå› ä¸ºå£°æ˜æ—¶å€™ä¸çŸ¥é“ï¼Œåé¢ä¹Ÿä¸çŸ¥é“ï¼Œå³ä½¿è¢«èµ‹å€¼äº†ï¼Œä½†æ˜¯åé¢å¯èƒ½æœ‰å˜åŒ–

function addTen(a) { // aä½œä¸ºå…¥å‚
  return a + 10; // ä½ ä¼šè®¤ä¸ºåº”è¯¥æ˜¯stringæˆ–è€…numberï¼Œä½†æ˜¯tsè¿™è ¢è´§å°±æ˜¯æŒ‰ç…§é»˜è®¤anyèµ°ğŸ¥²
}
const fourteen = addTen(4); // any
```

```tsx
function addTen(a = 1) { // æœ‰é»˜è®¤å€¼ï¼Œæ‰€ä»¥å¯ä»¥æ¨æ–­è¿”å›number
  return a + 10;
}
const fourteen = addTen(4); // number
```

## å‡½æ•°é»˜è®¤voidè¿”å›

```tsx
function logMessage(message: string) { // logMessageå‡½æ•°æ²¡æœ‰è¿”å›ï¼Œæ¨æ–­ä¸º (message: string) => void çš„ç­¾å
  console.log(message);
}
// å¦‚æœtsconfig.jsonçš„strictNullChecksç¼–è¯‘é€‰é¡¹å…³é—­ï¼Œè¿”å›nullä¹Ÿæ˜¯å¯ä»¥çš„

let whatCanIHold: void;
whatCanIHold = undefined; // ok
whatCanIHold = null // ok, `--strictNullChecks` is not given
whatCanIHold = '123' // error
```

## æ•°ç»„

```tsx
const items = []; // é»˜è®¤å°±æ˜¯any
items.push(1);
items.push("two");
items.push(false);
console.log(items); // any[]
```

## voidå’Œneverçš„åŒºåˆ«

```tsx
const keepLogging = (message: string) => {
  while (true) {
    console.log(message);
  }
};

// è¿™ä¸ªå‡½æ•°è¿”å›ä»€ä¹ˆï¼Ÿ
// never
```

å‡½æ•°æ²¡æœ‰è¿”å›å€¼å°±æ˜¯voidï¼Œä½†æ˜¯è¿™é‡Œæ¨æ–­æ°¸è¿œä¸ä¼šæœ‰returnï¼ˆwhileå¾ªç¯ï¼‰,æ‰€ä»¥è¿”å›never

## ä»€ä¹ˆæƒ…å†µä¸‹ç”¨never?

å¦‚ä¸‹ï¼Œæœ‰çš„ä»£ç é€»è¾‘æ°¸è¿œä¸ä¼šæ‰§è¡Œåˆ°ï¼Œåˆ™æœæ–­ç”¨never

```tsx
type Status = "Pending" | "Working" | "Complete";

function neverReached(never: never) {} // never exec

function doSomeAction(status: Status) {
  switch (status) {
    case "Pending":
      // some code
      break;
    case "Working":
      // some code
      break;
    case "Complete":
      // some code
      break;
    default: 
      neverReached(status); // ä¸ä¼šæ‰§è¡Œåˆ°å£°æ˜ï¼Œperfect!
  }
}

doSomeAction("Pending");
```

## ä»€ä¹ˆæƒ…å†µä¸‹ç”¨unknown?unknownä¸anyçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

```tsx
function add(a: unknown, b: unknown) {
  return a + b; // error, (parameter) b: unknown, Object is of type 'unknown'.ts(2571)
}
```

ä¸anyä¸åŒï¼Œunknownä¼šæ‰§è¡Œæ£€æŸ¥ç„¶åæŠ¥é”™ï¼Œé™¤éä½ ç»§ç»­æŒ‡å®šç±»å‹ï¼Œanyæ˜¯åŸºæœ¬ä¸æ£€æŸ¥äº†ï¼Œæ‰€ä»¥æ­¤æ—¶éœ€è¦åŠ ä¸Šç±»å‹åˆ¤æ–­

```tsx
function add(a: unknown, b: unknown) {
  if (typeof a === "number" && typeof b === "number") {
    return a + b; // æ¨æ–­ä¸º number è¿”å›
  }
  return 0;
}
```

## ä½¿ç”¨isè¿›è¡Œfetchæ•°æ®çš„ç±»å‹æ¨æ–­

```tsx
async function getData(path: string): Promise<unknown> {
  const response = await fetch(path);
  return await response.json();
}

type Person = {
  id: string;
  name: string;
};

async function getPerson(id: string): Promise<Person | null> {
  const person = await getData("/people/1");
  if (person) {
    return person; // error, person be return to unknown
  }
  return null;
}
```

æ­¤æ—¶ï¼Œå› ä¸ºgetDataè¿”å›çš„æ˜¯unknownï¼Œä½†æ˜¯getPersonéœ€è¦è¿”å›Personæˆ–è€…nullï¼Œå°±æŠ¥é”™äº†ã€‚æ”¹è¿›ä¸€ä¸‹ï¼Œå¼•å…¥isåˆ¤æ–­ç±»å‹

```tsx
async function getData(path: string): Promise<unknown> {
  const response = await fetch(path);
  return await response.json();
}

type Person = {
  id: string;
  name: string;
};

async function getPerson(id: string): Promise<Person | null> {
  const person = await getData("/people/1");
  if (person && isPerson(person)) { // ç±»å‹åˆ¤æ–­
    return person;
  }
  return null;
}

function isPerson(person: any): person is Person { // æ³¨æ„è¿™é‡Œçš„ is, è¡¨ç¤ºè¿”å›æ˜¯true or false
  return "id" in person && "name" in person;
}
```

## consoleåˆ°åº•è¿”å›ä»€ä¹ˆï¼Ÿ

```tsx
function logMessage(message: string) {
  return console.log(message);
}
// ä¸Šé¢å‡½æ•°åˆ°åº•è¿”å›äº†ä»€ä¹ˆï¼Ÿ
```

ç­”æ¡ˆæ˜¯voidï¼Œconsole.logæ²¡æœ‰è¿”å›ä»»ä½•ä¸œè¥¿ï¼Œ`Console.log(message?: any, ...optionalParams: any[]): void` æ‰€ä»¥logMessageä¹Ÿè¿”å›äº†void

## interfaceå¦‚ä½•å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼Ÿ

```tsx
interface Log {
  (message: string): void; // æ³¨æ„è¿™é‡Œï¼Œå£°æ˜äº†ä¸€ä¸ªå‡½æ•°ï¼Œä½†æ˜¯Logæ¥å£æ²¡æœ‰keyï¼Œæ‰€ä»¥Logå°±æˆä¸ºå‡½æ•°ç­¾åï¼Œç­‰ä»·äº type Log = (message: string) => void
}

const log: Log = (message: string) => {
  console.log(message);
};
```

## union type and intersection typeï¼ˆè”åˆç±»å‹å’Œäº¤å‰ç±»å‹ï¼‰

```tsx
type A_or_B_or_C = 1 | 2 | 3;
const a: A_or_B_or_C = 1 // ok, union type, é€‰æ‹©å…¶ä¸€

type Name = {
  firstName: string;
  lastName: string;
};
type PhoneNumber = {
  landline: string;
  mobile: string;
};

type Contact = Name & PhoneNumber; // Contact æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ

const fred: Contact = { // intersectionäº¤å‰ç±»å‹æŠŠæ‰€æœ‰å±æ€§éƒ½å›Šæ‹¬äº†,ç¼ºä¸€ä¸å¯
  firstName: "Fred",
  lastName: "Smith",
  landline: "0116 4238978",
  mobile: "079543 4355435",
};
```

äº¤å‰ç±»å‹è·Ÿinterfaceæ‰©å±•ç±»ä¼¼ï¼Œåœ¨æ‰©å±•å±æ€§ä¸Šä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œå¦‚ `type Contact = Name & PhoneNumber & Email;` Emailç±»å‹æ‰©å±•äº†å±æ€§ï¼Œä½†æ˜¯ä¹Ÿé‡æ–°å£°æ˜äº†å˜é‡ï¼Œå¦‚æœæœ‰é‡å¤ä»¥ `&` åé¢åŠ å…¥çš„ä¸ºå‡†ï¼Œä½†æ˜¯å¦‚æœæ˜¯å‡½æ•°æˆå‘˜å‘¢ï¼Ÿ

```tsx
type A = {
  doIt: (a: string) => void;
};
type B = {
  doIt: (a: string, b: string) => void;
};
type A_and_B = A & B;

const ab_v1: A_and_B = {
  doIt: (a: string) => {}, // ä¼šå‘ç”Ÿé”™è¯¯å—ï¼Ÿ ç­”æ¡ˆæ˜¯ä¸ä¼š
  // doIt: (a: string, b: string) => {}, // è¿™æ ·å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ä¼šå‘ç”Ÿé”™è¯¯
};
```

ä¸ºä»€ä¹ˆå‘¢ï¼Ÿäº¤é›†ç±»å‹çš„å…¬å…±å‡½æ•°æˆå‘˜çš„å‚æ•°åœ¨æ•°å­¦ä¸Šæ˜¯ç›¸äº¤çš„ï¼Œä¹Ÿå°±æ˜¯è¯´`doIt: (a: string) => void;` ä¸ `doIt: (a: string, b: string) => void;` äº¤å‰çš„è¯ï¼Œæœ€åå¾—åˆ°çš„æ˜¯å‰è€…ï¼Œå¯ä»¥ç†è§£ä¸ºå…¶å®æ˜¯å‡½æ•°çš„å‚æ•°è¿›è¡Œäº†äº¤å‰å–äº¤é›†ã€‚æ‰€ä»¥åªæœ‰aå‚æ•°æ²¡é—®é¢˜ï¼Œä½†æ˜¯å¤šäº†bå‚æ•°å°±å‘ç”Ÿé”™è¯¯äº†ã€‚è¿™ä¹Ÿæ˜¯å‡½æ•°ç­¾åçš„å°ç»†èŠ‚

## interface vs type

[Interfaces v type aliases | Learn TypeScript](https://learntypescript.dev/04/l7-interfaces-v-type-aliases)

æ€»ç»“ä¸€ä¸‹ï¼Œé™¤äº†ç»™åº“å†™å£°æ˜ä½¿ç”¨interfaceï¼Œå…¶ä»–æ—¶å€™ä½¿ç”¨typeæ˜¯æ›´ç®€æ´çš„ã€‚åº“å£°æ˜æ–¹ä¾¿åº“ä¸ç»´æŠ¤æ—¶å€™ï¼Œåç»­å¼€å‘è€…å¯ä»¥æ–¹ä¾¿æ‰©å±•

## class methods overload

```tsx
class Product {
  constructor(public name: string, public price: number) {}
}

class Products {
  private products: Product[] = [];
  add(product: Product) {
    this.products.push(product);
  }

  filter(name: string): Product[]; // æ³¨æ„è¿™é‡Œoverloadäº†å¤šä¸ªç­¾åï¼Œideä¼šæç¤º (method) Products.filter(name: string, price: number): Product[] (+1 overload)
	filter(name: string, price: number): Product[];
  filter(name: string, price?: number): Product[] {
    if (price === undefined) {
      return this.products.filter((product) => product.name === name);
    } else {
      return this.products.filter(
        (product) => product.name === name && product.price === price
      );
    }
  }
}

const products = new Products();
products.add(new Product("Table", 400));
products.add(new Product("Chair", 100));
products.add(new Product("Lamp", 30));
console.log(products.filter('test', 100));
```

## ç±»ç»§æ‰¿éœ€è¦super

```tsx
class Product {
  constructor(public name: string, public price: number) {}
  log() {
    console.log(this.name, this.price);
  }
}

class Table extends Product {
  constructor(public name: string, public price: number) {
    
  }
}

// è¿™æ®µä»£ç å¯ä»¥æ‰§è¡Œå—ï¼Ÿ
// ä¸è¡Œï¼ŒTableå­ç±»ç¼ºå°‘Productæ„é€ å‡½æ•°çš„è°ƒç”¨ã€‚super(â€¦â€¦)
```

```tsx
// é‚£ä¹ˆä¸‹é¢è¿™æ®µä»£ç æœ‰é”™è¯¯å—ï¼Ÿè¾“å‡ºäº†ä»€ä¹ˆï¼Ÿ
abstract class Animal {
  constructor(public name: string) {}
  protected log(message: string) {
    console.log(message);
  }
}
class Dog extends Animal {
  bark() {
    this.log(this.name + " Bark");
  }
}
const dog = new Dog("Fudge");
dog.bark();
```

æ²¡é”™è¯¯ï¼Œåªè¦Dogå­ç±»ä¸å†™constructorï¼Œé‚£å°±ä¸éœ€è¦åšsuperè°ƒç”¨ã€‚new Dogç›´æ¥è·‘Animalçš„æ„é€ å‡½æ•°ï¼Œæœ€åè¾“å‡ºâ€™Fudge Barkâ€™

## å¦‚ä½•å£°æ˜ä¸€ä¸ªäºŒç»´æ•°ç»„

```tsx
type Coordinate = number[] // ä¸€çº¬æ•°ç»„
type TwoDimension = Array<Coordinate> // äºŒçº¬æ•°ç»„ï¼Œä½¿ç”¨äº†æ³›å‹ Generic Type
```

## å¦‚ä½•å£°æ˜ä¸€ä¸ªåªæœ‰aå’Œbå±æ€§çš„å¯¹è±¡ï¼Ÿ

```tsx
type Obj = Record<'a' | 'b', any>
const Obj = {
	a: {}
}
```

## æ³›å‹é»˜è®¤å€¼

```tsx
function firstOrNull<T = string>(array: T[]): T | null { // èŒƒå‹Té»˜è®¤æ˜¯stringç±»å‹ï¼Œä½†æ˜¯ä¸‹æ–¹ä¼ å…¥äº†numberç±»å‹è¦†ç›–äº†
  return array.length === 0 ? null : array[0];
}
const first = firstOrNull<number>([1, 2, 3]);
console.log(first);
```

## å¦‚ä½•ä½¿ç”¨èŒƒå‹ç¼©å°è¿”å›ç±»å‹èŒƒå›´ï¼Ÿ

```tsx
function merge(names: string[], scores: number[]) {
  return [...names, ...scores];
}
let scores = merge(["Bill", "Jane"], [8, 9]); 
// scoreç±»å‹ä¸º (string | number)[]ï¼Œçœ‹èµ·æ¥å¥½åƒOKäº†ï¼Œä½†æ˜¯æˆ‘éœ€è¦æ¯ä¸€ä¸ªnames,scoresé¡¹çš„å€¼
// å¦‚ "Bill" | "Jane" | 8 | 9 è¦æ€ä¹ˆå†™å‘¢ï¼Ÿ
// æç¤ºï¼š extends å¯ä»¥ç¼©å°èŒƒå›´ï¼ŒèŒƒå‹ä¼šè®©ç±»å‹å¼€å§‹æ¨å¯¼

// ---------------------------------------------------------
// perfect
function merge<Names extends string[], Scores extends number[]>(
  names: [...Names],
  scores: [...Scores]
): [...Names, ...Scores] {
  return [...names, ...scores];
}

let scores = merge(["Bill", "Jane"], [8, 9]);
```

## éç©ºæ–­è¨€

```tsx
return text!.concat(text!); // !. åœ¨è¿™é‡Œè¡¨ç¤ºå¿…ç„¶æœ‰concatæ–¹æ³•

type Obj = {
	a ?: string // optionalå¯é€‰çš„
}
```

## is æ–­è¨€å‡½æ•°è¿”å›å€¼

```tsx
interface Product {
  name: string;
  price: number;
  getPrice: () => number;
}
interface DiscountedProduct {
  name: string;
  price: number;
  getPrice: () => number;
  getDiscountedPrice: () => number;
}
function getPrice(product: Product | DiscountedProduct) {
  if (isDiscountedProduct(product)) { // ifåˆ¤æ–­ï¼Œéœ€è¦ä¸€ä¸ªtrue/false
    return product.getDiscountedPrice();
  } else {
    return product.getPrice();
  }
}
function isDiscountedProduct( // isDiscountedProduct ä¸€ä¸ªç±»å‹åˆ¤æ–­å‡½æ•°ï¼Œè¿”å›true/false
  product: Product | DiscountedProduct
): product is DiscountedProduct { // æ³¨æ„è¿™é‡Œï¼Œis åˆ¤æ–­å°±æ˜¯æ¨æ–­true/false
  return product.price > 10;
}
```

## assertsâ€¦â€¦isâ€¦â€¦

æ–­è¨€ç­¾åï¼Œå¦‚æœæ²¡æœ‰throwå¼‚å¸¸ï¼Œåˆ™æŒ‰ç…§assertsæ–­è¨€ç¼©å°ç±»å‹èŒƒå›´

```tsx
interface Person {
  firstName: string;
  surname: string;
}
interface Organisation {
  name: string;
}
type Contact = Person | Organisation;

function assertIsPerson(contact: Contact): asserts contact is Person { // å¦‚æœæ²¡æœ‰ç±»å‹å¼‚å¸¸åˆ™contactå°±æ˜¯Personç±»å‹
  if ((contact as Person).firstName === undefined) {
    throw new Error("Not a person");
  }
}

function sayHello(contact: Contact) {
  assertIsPerson(contact); // å…·ä½“éœ€è¦çœ‹æ˜¯å¦æœ‰æŠ›å‡ºç±»å‹å¼‚å¸¸ï¼Œè¿™é‡Œæ²¡æœ‰ifåˆ¤æ–­
  console.log("Hello " + contact.firstName);
}

const bob: Person = {
  firstName: "Bob",
  surname: "Young",
};

const redBricks: Organisation = {
  name: "Red Bricks",
};

sayHello(bob);
sayHello(redBricks);
```

## ç¼©å°ç±»å‹èŒƒå›´æœ‰å“ªäº›åŠæ³•ï¼Ÿ

- `<TypeName>`å¼ºåˆ¶è½¬åŒ–æˆ–è€…`as`æ¨æ–­ï¼Œæ¯”å¦‚ `<HTMLButtonElement>document.querySelector(".go");` æˆ–è€… `document.querySelector(".go") as HTMLButtonElement`
- `===`ï¼Œæ¯”å¦‚*`if* (text === *null* || text === undefined) { // è¿™é‡Œåªèƒ½æ˜¯null or undefined }`
- `typeof`
- `instanceof`ï¼Œå› ä¸ºç»§æ‰¿çš„å­˜åœ¨ï¼Œä¸€èˆ¬åˆ¤æ–­å­ç±»/çˆ¶ç±»çš„æ—¶å€™å¯ä»¥ç”¨æ¥åŒºåˆ†
- `in`
- `is`
- assertsâ€¦â€¦is

## `-`åè½¬å«ä¹‰

```tsx
type Contact = {
  name: string;
  email?: string;
};

type RequiredProperties<T> = {
  [K in keyof T]-?: string; // ? æœ¬æ¥æ˜¯å¯é€‰çš„ï¼ŒåŠ ä¸Š - å°±æ˜¯å¿…é€‰äº† 
};
const bob: RequiredProperties<Contact> = {
  name: "Bob" // error, ç¼ºå°‘emailå­—æ®µ
};

console.log(bob)
```

åŒç†readonlyæ˜¯åªè¯»çš„ï¼Œä½†æ˜¯åŠ ä¸Š -readonly å°±æ˜¯éåªè¯»ï¼ˆè¯»å†™éƒ½å¯ä»¥ï¼‰ï¼Œå¦‚ä¸‹

```tsx
{
  -readonly [K in keyof T]: TypeName
}
```

## æ¡ä»¶ç±»å‹Conditional Type

```tsx
type NonNullable<T> = T extends null | undefined ? never : T;
```

å¦‚ä¸Šï¼Œç®€å•æ¡ä»¶ç±»å‹ç»“åˆnever å°±å¯ä»¥ç§»é™¤ null å’Œ undefined

## inferï¼ˆé‡è¦ï¼‰

```tsx
type ArrayElementType<T> = T extends (infer E)[] ? E : T; // è‡ªåŠ¨æ¨æ–­æ•°ç»„itemçš„ç±»å‹

// type of item1 is `number`
type item1 = ArrayElementType<number[]>;

// type of item1 is `{name: string}`
type item2 = ArrayElementType<{ name: string }>;

// ------------------------------------------------------------------------------------------
function addPerson(personName: string) {
  return {
    type: "AddPerson",
    payload: personName
  };
}

function removePerson(id: number) {
  return {
    type: "RemovePerson",
    payload: id
  };
}

type AddPersonType = typeof addPerson;
type RemovePersonType = typeof removePerson;
type FunctionReturnType<T> = T extends (...args: any) => infer R ? R: T // æ³¨æ„è¿™é‡Œï¼ŒTå¦‚æœæ˜¯ä¸ªå‡½æ•°åˆ™è¿”å›å‡½æ•°è¿”å›å€¼ï¼Œå¦åˆ™å°±è¿”å›T

type Actions =
  | FunctionReturnType<AddPersonType>
  | FunctionReturnType<RemovePersonType>; // Actionsæ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ
// ç­”æ¡ˆæ˜¯ {type: string, payload: string} | {type: string, payload: number}

const person = { name: "Fred" };
type PersonType = FunctionReturnType<typeof person>; // PersonTypeæ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ
// ç­”æ¡ˆæ˜¯ {name: string}
```

## ä¸€ä¸ªç®€å•å‡½æ•°ç­¾åæ€ä¹ˆå†™ï¼Ÿå¼‚æ­¥å‡½æ•°å‘¢ï¼Ÿ

```tsx
type Fn = (...args: any[]) => void;

// å¦ä¸€ä¸ªèŒƒå‹è¦ç¼©å°èŒƒå›´åˆ°å‡½æ•°è¦æ€ä¹ˆå†™ï¼Ÿ
type FunctionReturnType<
  T extends Fn // æ³¨æ„è¿™é‡Œï¼Œç¼©å°äº†èŒƒå‹çš„èŒƒå›´ä¸ºå‡½æ•°
> = T extends (...args: any) => infer R ? R : T;

// -------------------------------------------------
// å¼‚æ­¥å‡½æ•° Promise
type AsyncFunctionReturnType<
  T extends Fn // æ³¨æ„è¿™é‡Œï¼Œç¼©å°äº†èŒƒå‹çš„èŒƒå›´ä¸ºå‡½æ•°
> = T extends (...args: any) => Promise<infer R> ? R : T; // è¿™é‡ŒTå¦‚æœæ˜¯å¼‚æ­¥å‡½æ•°çš„å­é›†ï¼Œè€Œä¸”éœ€è¦æ¨æ–­å¼‚æ­¥å‡½æ•°è¿”å›å€¼ç±»å‹

type asyncFn = (...args: any[]) => Promise<number>; // ä¸€ä¸ªè¿”å›numberç±»å‹çš„å¼‚æ­¥å‡½æ•°

type test = AsyncFunctionReturnType<asyncFn> // type test = number
```

## Utility Types å¯¹åº”

```tsx
type RemoveFromUnion<T, K> = K extends T ? never: K // å¯¹åº”ä»€ä¹ˆutility typesæ–¹æ³•ï¼Ÿ

type ObjectWithKeys<T, K extends keyof T> = { // å¯¹åº”ä»€ä¹ˆutility typesæ–¹æ³•ï¼Ÿ
  [P in K]: T[P];
};

type ObjectWithoutKeys<T, K extends keyof T> = ObjectWithKeys< // å¯¹åº”ä»€ä¹ˆutility typesæ–¹æ³•ï¼Ÿ
  T,
  RemoveFromUnion<keyof T, K>
>;

// RemoveFromUnion -> Exclude
// ObjectWithKeys -> Pick
// ObjectWithoutKeys -> Omit
```

## readonlyæ˜¯shallow check

```tsx
let bill = Object.freeze({ // çŒœçŒœbillæ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ
  scores: [90, 65, 80],
  profile: {
    level: 1
  }
});

// billç±»å‹
// let bill: Readonly<{
//   scores: number[];
//   profile: {
//     level: number;
//   };
// }>;

bill.scores.push(100); // ä¼šå‘ç”Ÿé”™è¯¯å—ï¼Ÿ
bill.profile.level = 2; // ä¼šå‘ç”Ÿé”™è¯¯å—ï¼Ÿ
```

æœ€åä¸¤è¡Œéƒ½ä¸ä¼šå‘ç”Ÿé”™è¯¯ï¼Œæœ¬è´¨æ˜¯`Object.freeze`è¿”å›çš„`readonly`åªä½œç”¨äºæµ…å±‚ï¼Œå³åªå¯¹`bill.scores`å’Œ`bill.profile`èµ·ä½œç”¨ï¼Œä¸èƒ½ä¿®æ”¹è¿™ä¸¤ä¸ªå±æ€§çš„å¼•ç”¨ï¼Œå¦‚ `bill.scores = {}` å°±ä¼šå¼•èµ·æŠ¥é”™ï¼Œä½†æ˜¯ä¸‹ä¸€å±‚åˆ™ä¸ä¼šå—å½±å“ã€‚ä¸ä¹‹ç±»ä¼¼ï¼Œ`Object.freeze` ä¹Ÿæ˜¯åªå†»ç»“æµ…å±‚å¼•ç”¨ä¸èƒ½ä¿®æ”¹ï¼Œæ·±å±‚æ¬¡ä¿®æ”¹ä¹Ÿæ˜¯ä¸ä¼šæŠ¥é”™çš„ã€‚

## å¸¸é‡æ–­è¨€ as const

```tsx
const tuple = ["tesla", "model 3", "model X", "model Y"] as const; // æ•°ç»„çš„æ¯ä¸€é¡¹éƒ½å˜ä¸ºreadonly

const bill = {
  name: "Bill",
  profile: {
    level: 1,
  },
  scores: [90, 65, 80],
} as const; // çŒœçŒœbillæ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ

// const bill: {
//   readonly name: "Bill";
//   readonly profile: {
//     readonly level: 1;
//   };
//   readonly scores: readonly [90, 65, 80];
// };
```

ç­”æ¡ˆæ˜¯å­å±æ€§å…¨éƒ¨å˜ä¸ºreadonly

# èµ„æºæ¨è
- [ç®€å•å…¨é¢çš„å…¥é—¨](https://learntypescript.dev/)ï¼Œä¸»è¦æ˜¯ä¸€äº›ä¸å¸¸è§çš„æ¯”å¦‚ `!.`å’Œ`-readonly`ï¼Œ`asserts is`ç­‰éƒ½ä¼šæœ‰äº†è§£
- [TSæŒ‘æˆ˜](https://github.com/type-challenges/type-challenges) ä¸Šé¢ç†Ÿæ‚‰åè¿˜æƒ³ç»§ç»­ç ”ç©¶çš„å¯ä»¥è¯•è¯•TSæŒ‘æˆ˜é¡¹ç›®