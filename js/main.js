(function(){function i(){var i=50,n=150,t=document.querySelector("#header"),a=document.createElement("canvas"),e=a.getContext("2d"),r=t.clientWidth,s=t.clientHeight,l=0,o=false,h=[],c=null;a.style.cssText="position:absolute;top:0;transform:translateZ(0);";var d=function(){this.x=0;this.y=0;this.vy=0;this.vx=0;this.r=0;this.reset()};d.prototype.reset=function(){this.x=Math.random()*r;this.y=Math.random()*-s;this.vy=1+Math.random()*3;this.vx=.5-Math.random();this.r=1+Math.random()*2;this.o=.5+Math.random()*.5};function f(){for(l=0;l<n;l++){c=new d;c.reset();h.push(c)}}f();function m(){e.clearRect(0,0,r,s);if(!o){return}for(l=0;l<i;l++){c=h[l];c.y+=c.vy;c.x+=c.vx;e.globalAlpha=c.o;e.beginPath();e.arc(c.x,c.y,c.r,0,Math.PI*2,false);e.closePath();e.fill();if(c.y>s){c.reset()}}requestAnimFrame(m)}function u(){r=t.clientWidth;s=t.clientHeight;a.width=r;a.height=s;e.fillStyle="#fff";var i=o;o=r>480;if(!i&&o){requestAnimFrame(m)}}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(i){window.setTimeout(i,1e3/60)}}();u();window.addEventListener("resize",u,false);t.appendChild(a)}i()})();(function(i){i("#back-to-top").on("click",function(){i("body, html").animate({scrollTop:0},600)});i("#main-nav-toggle").on("click",function(){i(".nav-container-inner").slideToggle()});i(".article-entry").each(function(n){i(this).find("img").each(function(){if(i(this).parent().hasClass("fancybox")){return}var n=this.alt;if(n){i(this).after('<span class="caption">'+n+"</span>")}i(this).wrap('<a href="'+this.src+'" title="'+n+'" class="fancybox"></a>')});i(this).find(".fancybox").each(function(){i(this).attr("rel","article"+n)})});if(i.fancybox){i(".fancybox").fancybox()}i("#sidebar .sidebar-toggle").click(function(){if(i("#sidebar").hasClass("expend")){i("#sidebar").removeClass("expend")}else{i("#sidebar").addClass("expend")}});i(".main-nav-list > li").unwrap();i("#main-nav > li > .main-nav-list-link").each(function(){if(i(".page-title-link").length>0){if(i(this).html().toUpperCase()==i(".page-title-link").html().toUpperCase()){i(this).addClass("current")}else if(i(this).attr("href")==i(".page-title-link").attr("data-url")){i(this).addClass("current")}}});function n(){var n=i(".nav-container-inner").width()-10;var t=i("#main-nav").width();var a=i("#sub-nav").width();if(t+a>n){if(i(".main-nav-more").length==0){i(['<li class="main-nav-list-item top-level-menu main-nav-more">','<a class="main-nav-list-link" href="javascript:;">More</a>','<ul class="main-nav-list-child">',"</ul></li>"].join("")).appendTo(i("#main-nav"));i(".main-nav-more").hover(function(){if(i(window).width()<480){return}i(this).children(".main-nav-list-child").slideDown("fast")},function(){if(i(window).width()<480){return}i(this).children(".main-nav-list-child").slideUp("fast")})}var e=i("#main-nav").children().length;for(var r=e-2;r>=0;r--){var s=i("#main-nav").children().eq(r);if(t+a>n){s.prependTo(i(".main-nav-more > ul"));t=i("#main-nav").width()}else{return}}}if(i(".main-nav-more").length>0){i(".main-nav-more > ul").children().appendTo(i("#main-nav"));i(".main-nav-more").remove()}}n();i(window).resize(function(){n()});i(".main-nav-list-item").hover(function(){if(i(window).width()<480){return}i(this).children(".main-nav-list-child").slideDown("fast")},function(){if(i(window).width()<480){return}i(this).children(".main-nav-list-child").slideUp("fast")});i(".main-nav-list-item").each(function(){if(i(this).find(".main-nav-list-child").length>0){i(this).addClass("top-level-menu")}});function t(){var n=i(".sidebar-top"),t=n.offset().top,a=i("#sidebar"),e=i(window);function r(){var i=e.scrollTop();if(i>t){n.addClass("fixSidebar")}else{n.removeClass("fixSidebar")}}return r}i(window).scroll(t())})(jQuery);